# Framework Architecture

> How this AI-driven development framework is organized and why

**Last Updated:** 2026-02-07
**Version:** 2.0

---

## Design Philosophy

This framework follows a **single source of truth with multi-tool compatibility** approach:

1. **All AI rules live in `.ai/` folder** (one place to edit)
2. **Tool-specific folders reference `.ai/`** (compatibility without duplication)
3. **Progressive disclosure** (load context on-demand, not all at once)
4. **Template-driven** (bootstrap generates customized files)

---

## Directory Structure

```
project-root/
â”œâ”€â”€ AGENTS.md                    # Universal entry point (all AI tools)
â”œâ”€â”€ CLAUDE.md                    # Quick context for Claude Code
â”œâ”€â”€ ARCHITECTURE.md              # Framework architecture guide
â”œâ”€â”€ README.md                    # Human-facing project docs
â”‚
â”œâ”€â”€ .ai/                         # ğŸ¯ SINGLE SOURCE OF TRUTH
â”‚   â”œâ”€â”€ .version                 # Framework version tracking
â”‚   â”œâ”€â”€ CHANGELOG.md             # Framework change history
â”‚   â”œâ”€â”€ decision-boundaries.md   # Authority matrix for agents
â”‚   â”‚
â”‚   â”œâ”€â”€ agents/                  # Agent role definitions
â”‚   â”‚   â”œâ”€â”€ builder.md           # Technical implementation
â”‚   â”‚   â”œâ”€â”€ operator.md          # Deployment & operations
â”‚   â”‚   â”œâ”€â”€ communicator.md      # Docs & user-facing content
â”‚   â”‚   â””â”€â”€ strategist.md        # Prioritization & planning
â”‚   â”‚
â”‚   â”œâ”€â”€ contexts/                # Project context (load on-demand)
â”‚   â”‚   â”œâ”€â”€ README.md            # How to use contexts
â”‚   â”‚   â”œâ”€â”€ current-priorities.md
â”‚   â”‚   â”œâ”€â”€ product-context.md
â”‚   â”‚   â”œâ”€â”€ domain-context.md.example
â”‚   â”‚   â””â”€â”€ holus.md       # Generated by bootstrap
â”‚   â”‚
â”‚   â”œâ”€â”€ standards/               # Code & design standards
â”‚   â”‚   â”œâ”€â”€ code/
â”‚   â”‚   â”‚   â”œâ”€â”€ typescript.md
â”‚   â”‚   â”‚   â”œâ”€â”€ react.md
â”‚   â”‚   â”‚   â””â”€â”€ testing.md
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â””â”€â”€ design.md
â”‚   â”‚   â”œâ”€â”€ security/
â”‚   â”‚   â”‚   â””â”€â”€ baseline.md
â”‚   â”‚   â””â”€â”€ comms/
â”‚   â”‚       â””â”€â”€ voice.md
â”‚   â”‚
â”‚   â”œâ”€â”€ workflows/               # Process workflows
â”‚   â”‚   â”œâ”€â”€ ship-feature.md
â”‚   â”‚   â”œâ”€â”€ investigate-bug.md
â”‚   â”‚   â”œâ”€â”€ customer-feedback.md
â”‚   â”‚   â””â”€â”€ weekly-ops.md
â”‚   â”‚
â”‚   â””â”€â”€ templates/               # Output templates
â”‚       â”œâ”€â”€ pr-description.md
â”‚       â”œâ”€â”€ changelog-entry.md
â”‚       â”œâ”€â”€ customer-response.md
â”‚       â””â”€â”€ weekly-update.md
â”‚
â”œâ”€â”€ .claude/                     # Claude Code specific
â”‚   â”œâ”€â”€ settings.json            # Claude preferences
â”‚   â”œâ”€â”€ commands/                # Slash commands
â”‚   â”‚   â””â”€â”€ README.md            # (placeholder for custom commands)
â”‚   â””â”€â”€ skills/                  # On-demand skills (symlinked)
â”‚       â”œâ”€â”€ builder/             â†’ References .ai/agents/builder.md
â”‚       â”œâ”€â”€ operator/            â†’ References .ai/agents/operator.md
â”‚       â”œâ”€â”€ communicator/        â†’ References .ai/agents/communicator.md
â”‚       â””â”€â”€ strategist/          â†’ References .ai/agents/strategist.md
â”‚
â”œâ”€â”€ .github/                     # GitHub specific
â”‚   â”œâ”€â”€ copilot-instructions.md  # GitHub Copilot entry point
â”‚   â”‚
â”‚   â”œâ”€â”€ agents/                  # GitHub agent system
â”‚   â”‚   â”œâ”€â”€ builder.agent.md     â†’ References .ai/agents/builder.md
â”‚   â”‚   â”œâ”€â”€ operator.agent.md    â†’ References .ai/agents/operator.md
â”‚   â”‚   â”œâ”€â”€ communicator.agent.md â†’ References .ai/agents/communicator.md
â”‚   â”‚   â””â”€â”€ strategist.agent.md  â†’ References .ai/agents/strategist.md
â”‚   â”‚
â”‚   â”œâ”€â”€ instructions/            # Language/framework specific
â”‚   â”‚   â”œâ”€â”€ typescript.instructions.md â†’ References .ai/standards/code/
â”‚   â”‚   â”œâ”€â”€ react.instructions.md      â†’ References .ai/standards/code/
â”‚   â”‚   â”œâ”€â”€ api.instructions.md        â†’ References .ai/standards/api/
â”‚   â”‚   â”œâ”€â”€ testing.instructions.md    â†’ References .ai/standards/code/
â”‚   â”‚   â””â”€â”€ security.instructions.md   â†’ References .ai/standards/security/
â”‚   â”‚
â”‚   â”œâ”€â”€ workflows/               # CI/CD workflows
â”‚   â”‚   â””â”€â”€ ci.yml
â”‚   â”‚
â”‚   â”œâ”€â”€ ISSUE_TEMPLATE/          # Issue templates
â”‚   â”‚   â”œâ”€â”€ bug_report.yml
â”‚   â”‚   â”œâ”€â”€ feature_request.yml
â”‚   â”‚   â””â”€â”€ config.yml
â”‚   â”‚
â”‚   â””â”€â”€ PULL_REQUEST_TEMPLATE.md
â”‚
â”œâ”€â”€ .agent/                      # Generic agent folder (Antigravity, Windsurf, etc.)
â”‚   â”œâ”€â”€ rules/
â”‚   â”‚   â”œâ”€â”€ README.md            # Explains reference system
â”‚   â”‚   â”œâ”€â”€ security.md          â†’ References .ai/standards/security/
â”‚   â”‚   â””â”€â”€ style.md             â†’ References .ai/standards/code/
â”‚   â”œâ”€â”€ workflows/
â”‚   â”‚   â””â”€â”€ deploy.md            â†’ References .ai/workflows/ + .ai/agents/operator.md
â”‚   â””â”€â”€ skills/                  # (empty by default, can reference .claude/skills/)
â”‚
â”œâ”€â”€ .codex/                      # Codex-based tools (optional)
â”‚   â”œâ”€â”€ README.md                # Explains symlinks
â”‚   â”œâ”€â”€ prompts/                 â†’ SYMLINK to .ai/workflows/
â”‚   â””â”€â”€ skills/                  â†’ SYMLINK to .ai/agents/
â”‚
â”œâ”€â”€ docs/                        # Human-facing documentation
â”‚   â””â”€â”€ playbooks/               # Step-by-step AI prompts
â”‚       â”œâ”€â”€ README.md            # Playbook overview & model recommendations
â”‚       â”œâ”€â”€ 0-quick-ref.md       # Quick reference card
â”‚       â”œâ”€â”€ 1-spec-create.md     # Write specifications
â”‚       â”œâ”€â”€ 2-spec-review.md     # Review specs
â”‚       â”œâ”€â”€ 3-implement.md       # Build features
â”‚       â”œâ”€â”€ 4-audit-logic.md     # Bug hunting
â”‚       â”œâ”€â”€ 5-audit-intent.md    # UX verification
â”‚       â”œâ”€â”€ 6-fix-iterate.md     # Apply fixes
â”‚       â””â”€â”€ hotfix.md            # Emergency fixes
â”‚
â”œâ”€â”€ specs/                       # Feature specifications
â”‚   â””â”€â”€ README.md                # Spec format and guidelines
â”‚
â””â”€â”€ .mcp.json                    # MCP server configuration
```

---

## The Reference System

### Why References Instead of Duplication?

Different AI tools look in different places:

| Tool | Looks for |
| --- | --- |
| **Claude Code** | `CLAUDE.md`, `.claude/` |
| **GitHub Copilot** | `.github/copilot-instructions.md`, `.github/instructions/` |
| **GitHub Agents** | `.github/agents/` |
| **Antigravity/Windsurf** | `.agent/` |
| **Codex tools** | `.codex/` |
| **Universal** | `AGENTS.md` |

Rather than copy-pasting content across all these locations, we:

1. âœ… **Store once** in `.ai/` folder
2. âœ… **Reference from** tool-specific folders
3. âœ… **Edit once**, applies everywhere

### Two Reference Strategies

**1. Symlinks** (when tool supports following symlinks)
```bash
.codex/prompts â†’ ../.ai/workflows/
.codex/skills â†’ ../.ai/agents/
```

**2. Reference files** (when tool needs actual files)
```markdown
# .github/agents/builder.agent.md
See the authoritative version at .ai/agents/builder.md
```

---

## File Flow

### Bootstrap Process

```
User runs bootstrap playbook
    â†“
AI asks questions one-at-a-time
    â†“
AI generates customized files:
  - AGENTS.md (with actual project name)
  - CLAUDE.md (with actual commands)
  - .ai/contexts/holus.md
  - .ai/decision-boundaries.md (with project rules)
    â†“
User reviews and commits
```

### Development Workflow

```
User wants to build feature
    â†“
AI loads AGENTS.md or CLAUDE.md
    â†“
AI reads relevant agent (.ai/agents/builder.md)
    â†“
AI loads standards (.ai/standards/code/)
    â†“
AI loads current context (.ai/contexts/current-priorities.md)
    â†“
AI follows workflow (.ai/workflows/ship-feature.md)
    â†“
AI implements with decision boundaries (.ai/decision-boundaries.md)
```

### Progressive Loading

âŒ **Don't load everything at once:**
```
Load AGENTS.md + CLAUDE.md + all agents + all standards + all contexts = context overflow
```

âœ… **Load progressively as needed:**
```
1. Load AGENTS.md (lightweight entry point)
2. Load relevant agent only (builder for features)
3. Load relevant standards only (TypeScript if working on TS)
4. Load contexts on-demand (product-context when making UX decisions)
```

---

## Tool Compatibility Matrix

| Location | Claude Code | Copilot | GitHub Agents | Antigravity | Codex | Universal |
|----------|-------------|---------|---------------|-------------|-------|-----------|
| `AGENTS.md` | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… |
| `CLAUDE.md` | âœ… | âŒ | âŒ | âŒ | âŒ | âŒ |
| `.ai/` | âœ… | âš ï¸ | âš ï¸ | âš ï¸ | âš ï¸ | âš ï¸ |
| `.claude/` | âœ… | âŒ | âŒ | âŒ | âŒ | âŒ |
| `.github/copilot-instructions.md` | âŒ | âœ… | âŒ | âŒ | âŒ | âŒ |
| `.github/agents/` | âŒ | âŒ | âœ… | âŒ | âŒ | âŒ |
| `.github/instructions/` | âŒ | âœ… | âŒ | âŒ | âŒ | âŒ |
| `.agent/` | âŒ | âŒ | âŒ | âœ… | âŒ | âŒ |
| `.codex/` | âŒ | âŒ | âŒ | âŒ | âœ… | âŒ |

âœ… = Primary support
âš ï¸ = Can be referenced but not automatically loaded

---

## Editing Guidelines

### âœ… Always Edit These:

- **`.ai/` folder** - Single source of truth for all AI rules
- **`AGENTS.md`** - Universal entry point (update when project changes)
- **`CLAUDE.md`** - Claude-specific quick reference
- **Playbooks** in `docs/playbooks/` - Human-facing workflows
- **Specs** in `specs/` - Feature specifications

### âš ï¸ Rarely Edit These:

- **`.github/agents/`** - Reference files (only edit to improve reference)
- **`.github/instructions/`** - Reference files (only edit to improve reference)
- **`.agent/`** - Reference files (only edit to improve reference)
- **`.codex/README.md`** - Documentation only

### âŒ Never Edit These:

- **`.codex/prompts/`** - Symlink (edit `.ai/workflows/` instead)
- **`.codex/skills/`** - Symlink (edit `.ai/agents/` instead)
- **`.claude/skills/`** - Symlinked folders (edit `.ai/agents/` instead)

---

## Version Management

### Framework Versions

Tracked in `.ai/.version`:
```
2.0.0
```

### Migration Path

When upgrading framework versions:
1. Check `.ai/CHANGELOG.md` for changes
2. Update `.ai/.version`
3. Test with your project
4. Update your project's `CHANGELOG.md`

---

## Key Principles

1. **Single Source of Truth** - All AI rules live in `.ai/`
2. **Multi-Tool Compatibility** - References allow any tool to work
3. **Progressive Disclosure** - Load context on-demand, not upfront
4. **Template-Driven** - Bootstrap generates custom files
5. **Validation-First** - Test framework before deploying to real projects
6. **Human + AI Collaboration** - Playbooks guide AI, agents execute autonomously

---

## Common Questions

### Q: Can I delete tool-specific folders I don't use?

**A:** Yes! If you don't use Codex, delete `.codex/`. If you don't use GitHub Agents, delete `.github/agents/`. The framework works with just:
- `AGENTS.md` (universal)
- `.ai/` (single source of truth)
- Tool-specific folder for YOUR tool

### Q: Why not just use symlinks everywhere?

**A:** Not all AI tools follow symlinks. Some need actual files. We use:
- **Symlinks** where supported (`.codex/`)
- **Reference files** where needed (`.github/agents/`, `.agent/`)

### Q: What if I want to customize for my team?

**A:** Edit files in `.ai/` folder. That's the whole point - one place to customize, applies everywhere.

### Q: How do I add a new agent?

**A:**
1. Create `.ai/agents/new-agent.md`
2. Update `AGENTS.md` to reference it
3. Create reference files in `.github/agents/new-agent.agent.md` if using GitHub
4. Add to `.claude/skills/` if using Claude Code

---

## Further Reading

- **Playbook Overview:** [docs/playbooks/README.md](docs/playbooks/README.md)
- **Context System:** [.ai/contexts/README.md](.ai/contexts/README.md)
- **Agent System:** `.ai/agents/` folder
- **Changelog:** [.ai/CHANGELOG.md](.ai/CHANGELOG.md)

## Project Overrides

- This repository keeps domain-specific architecture details in its existing docs.
- Pre-merge architecture notes (if present): `docs/project-overrides/ARCHITECTURE.premerge.md`.
- Generated framework architecture here defines AI workflow/ops structure only.
